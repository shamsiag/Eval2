{"ast":null,"code":"import html2pdf from \"html2pdf.js\";\nexport default {\n  name: \"InvoiceSection\",\n  data() {\n    return {\n      apiKey: localStorage.getItem(\"apiKey\"),\n      apiLink: localStorage.getItem(\"apiLink\"),\n      clientId: localStorage.getItem(\"clientId\"),\n      invoiceId: localStorage.getItem(\"invoiceId\")\n    };\n  },\n  created() {\n    this.getInvoice();\n    this.invoice = \"\";\n  },\n  methods: {\n    exportToPDF() {\n      html2pdf(document.getElementById(\"element-to-convert\"), {\n        margin: 1,\n        filename: \"generated-pdf.pdf\"\n      });\n    },\n    async getInvoice() {\n      try {\n        console.log('Tentative de récupération des produits depuis Dolibarr...');\n        if (!this.apiKey || !this.apiLink) throw new Error(\"API Key ou API Link manquant\");\n        const url = `${this.apiLink}/invoices/${this.invoiceId}`;\n        const response = await fetch(url, {\n          headers: {\n            \"DOLAPIKEY\": this.apiKey\n          }\n        });\n        if (!response.ok) throw new Error(`Erreur réseau: ${response.statusText}`);\n        const invoices = await response.json();\n        this.invoice = invoices => {\n          console.log(\"Facture récupéré:\", invoices);\n          return {\n            id: invoices.id,\n            ref: invoices.ref,\n            total_ht: invoices.total_ht,\n            total_tva: invoices.total_tva,\n            total_ttc: invoices.total_ttc,\n            product_name: invoices.lines.ref,\n            product_total_ht: invoices.lines.total_ht,\n            product_quantity: invoices.lines.qty,\n            product_unit_price_ht: invoices.lines.total_ht / invoices.lines.qty,\n            product_tva: invoices.lines.tva_tx,\n            date_creation: invoices.date_creation\n          };\n          inoi;\n        };\n        console.log('Produits récupérés et traités:', this.invoices);\n      } catch (error) {\n        console.error(\"Erreur lors de la récupération des produits:\", error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["html2pdf","name","data","apiKey","localStorage","getItem","apiLink","clientId","invoiceId","created","getInvoice","invoice","methods","exportToPDF","document","getElementById","margin","filename","console","log","Error","url","response","fetch","headers","ok","statusText","invoices","json","id","ref","total_ht","total_tva","total_ttc","product_name","lines","product_total_ht","product_quantity","qty","product_unit_price_ht","product_tva","tva_tx","date_creation","inoi","error"],"sources":["/Users/macbookpro/Sham/S6/stellarz-web/stellarz-b/stellar-web/src/components/InvoiceSection.vue"],"sourcesContent":["<template>\n    <div id=\"app\" ref=\"document\">\n      <div id=\"element-to-convert\">\n\n        <div class=\"logo\">\n            <img src=\"/Property 1=Variant2.png\" alt=\"Logo de la marque\" />\n        </div>\n\n        <div class=\"entete\">\n            <h1>Facture{{ invoice.ref}}</h1>\n            <h3>Date facturation : {{ invoice.date_creation}}</h3>\n            <h3>Date échéance : {{ invoice.date_creation}}</h3>\n        </div>\n\n        <div class=\"emetteur\">\n            <h3>VR 61 HF Ambohimiandra</h3>\n            <h3>101 Antananarivo</h3>\n            <h3>Madagascar</h3>\n            <h3>Tél.: +261349933136</h3>\n        </div>\n\n        <div class=\"client\">\n            <b>VR 61 HF Ambohimiandra</b>\n        </div>\n\n        <div class=\"ref-commande\">\n            <h4>Commandes</h4>\n            <h4>{{ invoice.ref}}</h4>\n            <h4>Réf. commande :</h4>\n            <h4>Date de commande : 09/04/2025</h4>\n        </div>\n\n        <table class=\"detail-commande\">\n        <tr>\n            <th class=\"detail-commande-designation\">Désignation</th>\n            <th>TVA   </th>\n            <th>P.U. HT</th>\n            <th>Qté</th>\n            <th>Total HT</th>\n        </tr>\n        <tr>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n        </tr>\n        </table>\n\n        <div class=\"bas-de-page\">\n            <b>Total HT</b>\n            <b>Total TVA</b>\n            <b>Total TTC</b>\n        </div>\n\n        <div class=\"details-paiement\">\n            <table class=\"small-table\">\n                <th>Versements déjà effectués</th>\n                <tr>\n                    <td>Règlement</td>\n                    <td>Montant</td>\n                    <td>Type</td>\n                </tr>\n                <tr>\n                    <td>Règlement</td>\n                    <td>Montant</td>\n                    <td>Type</td>\n                </tr>\n            </table>\n        </div>\n\n      </div>\n    </div>\n    <button @click=\"exportToPDF\">Export to PDF</button>\n  </template>\n\n<script>\nimport html2pdf from \"html2pdf.js\";\n\nexport default {\n  name: \"InvoiceSection\",\n  data() {\n    return {\n      apiKey: localStorage.getItem(\"apiKey\"),\n      apiLink: localStorage.getItem(\"apiLink\"),\n      clientId: localStorage.getItem(\"clientId\"),\n      invoiceId: localStorage.getItem(\"invoiceId\"),\n    };\n  },\n  created() {\n    this.getInvoice();\n    this.invoice=\"\";\n  },\n  \n  methods: {\n    exportToPDF() {\n      html2pdf(document.getElementById(\"element-to-convert\"), {\n        margin: 1,\n        filename: \"generated-pdf.pdf\",\n      });\n    },\n\n    async getInvoice(){\n        try {\n    console.log('Tentative de récupération des produits depuis Dolibarr...');\n    if (!this.apiKey || !this.apiLink) throw new Error(\"API Key ou API Link manquant\");\n\n    const url = `${this.apiLink}/invoices/${this.invoiceId}`;\n    const response = await fetch(url, {\n      headers: {\n        \"DOLAPIKEY\": this.apiKey\n      }\n    });\n\n    if (!response.ok) throw new Error(`Erreur réseau: ${response.statusText}`);\n\n    const invoices = await response.json();\n    this.invoice = invoices => {\n      console.log(\"Facture récupéré:\", invoices);\n      return {\n        id: invoices.id,\n        ref: invoices.ref,\n        total_ht: invoices.total_ht,\n        total_tva:invoices.total_tva,\n        total_ttc:invoices.total_ttc,\n        product_name: invoices.lines.ref,\n        product_total_ht: invoices.lines.total_ht,\n        product_quantity: invoices.lines.qty,\n        product_unit_price_ht: invoices.lines.total_ht/invoices.lines.qty,\n        product_tva: invoices.lines.tva_tx,\n        date_creation: invoices.date_creation\n        \n      };\n    inoi\n    };\n    \n    console.log('Produits récupérés et traités:', this.invoices);\n  } catch (error) {\n    console.error(\"Erreur lors de la récupération des produits:\", error);\n  }\n\n    },\n  },\n};\n</script>\n  \n  <style>\n  #app {\n    margin-top: 60px;\n  }\n  </style>"],"mappings":"AA6EA,OAAOA,QAAO,MAAO,aAAa;AAElC,eAAe;EACbC,IAAI,EAAE,gBAAgB;EACtBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,MAAM,EAAEC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;MACtCC,OAAO,EAAEF,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;MACxCE,QAAQ,EAAEH,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;MAC1CG,SAAS,EAAEJ,YAAY,CAACC,OAAO,CAAC,WAAW;IAC7C,CAAC;EACH,CAAC;EACDI,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,UAAU,CAAC,CAAC;IACjB,IAAI,CAACC,OAAO,GAAC,EAAE;EACjB,CAAC;EAEDC,OAAO,EAAE;IACPC,WAAWA,CAAA,EAAG;MACZb,QAAQ,CAACc,QAAQ,CAACC,cAAc,CAAC,oBAAoB,CAAC,EAAE;QACtDC,MAAM,EAAE,CAAC;QACTC,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ,CAAC;IAED,MAAMP,UAAUA,CAAA,EAAE;MACd,IAAI;QACRQ,OAAO,CAACC,GAAG,CAAC,2DAA2D,CAAC;QACxE,IAAI,CAAC,IAAI,CAAChB,MAAK,IAAK,CAAC,IAAI,CAACG,OAAO,EAAE,MAAM,IAAIc,KAAK,CAAC,8BAA8B,CAAC;QAElF,MAAMC,GAAE,GAAI,GAAG,IAAI,CAACf,OAAO,aAAa,IAAI,CAACE,SAAS,EAAE;QACxD,MAAMc,QAAO,GAAI,MAAMC,KAAK,CAACF,GAAG,EAAE;UAChCG,OAAO,EAAE;YACP,WAAW,EAAE,IAAI,CAACrB;UACpB;QACF,CAAC,CAAC;QAEF,IAAI,CAACmB,QAAQ,CAACG,EAAE,EAAE,MAAM,IAAIL,KAAK,CAAC,kBAAkBE,QAAQ,CAACI,UAAU,EAAE,CAAC;QAE1E,MAAMC,QAAO,GAAI,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;QACtC,IAAI,CAACjB,OAAM,GAAIgB,QAAO,IAAK;UACzBT,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEQ,QAAQ,CAAC;UAC1C,OAAO;YACLE,EAAE,EAAEF,QAAQ,CAACE,EAAE;YACfC,GAAG,EAAEH,QAAQ,CAACG,GAAG;YACjBC,QAAQ,EAAEJ,QAAQ,CAACI,QAAQ;YAC3BC,SAAS,EAACL,QAAQ,CAACK,SAAS;YAC5BC,SAAS,EAACN,QAAQ,CAACM,SAAS;YAC5BC,YAAY,EAAEP,QAAQ,CAACQ,KAAK,CAACL,GAAG;YAChCM,gBAAgB,EAAET,QAAQ,CAACQ,KAAK,CAACJ,QAAQ;YACzCM,gBAAgB,EAAEV,QAAQ,CAACQ,KAAK,CAACG,GAAG;YACpCC,qBAAqB,EAAEZ,QAAQ,CAACQ,KAAK,CAACJ,QAAQ,GAACJ,QAAQ,CAACQ,KAAK,CAACG,GAAG;YACjEE,WAAW,EAAEb,QAAQ,CAACQ,KAAK,CAACM,MAAM;YAClCC,aAAa,EAAEf,QAAQ,CAACe;UAE1B,CAAC;UACHC,IAAG;QACH,CAAC;QAEDzB,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAE,IAAI,CAACQ,QAAQ,CAAC;MAC9D,EAAE,OAAOiB,KAAK,EAAE;QACd1B,OAAO,CAAC0B,KAAK,CAAC,8CAA8C,EAAEA,KAAK,CAAC;MACtE;IAEE;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}