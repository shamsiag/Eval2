{"ast":null,"code":"import html2pdf from \"html2pdf.js\";\nexport default {\n  name: \"InvoiceSection\",\n  data() {\n    return {\n      apiKey: localStorage.getItem(\"apiKey\"),\n      apiLink: localStorage.getItem(\"apiLink\"),\n      clientId: localStorage.getItem(\"clientId\"),\n      invoiceId: localStorage.getItem(\"invoiceId\")\n    };\n  },\n  created() {\n    this.getInvoice();\n  },\n  methods: {\n    exportToPDF() {\n      html2pdf(document.getElementById(\"element-to-convert\"), {\n        margin: 1,\n        filename: \"generated-pdf.pdf\"\n      });\n    },\n    async getInvoice() {\n      try {\n        console.log('Tentative de récupération des produits depuis Dolibarr...');\n        if (!this.apiKey || !this.apiLink) throw new Error(\"API Key ou API Link manquant\");\n        const url = `${this.apiLink}/invoices/${this.invoiceId}`;\n        const response = await fetch(url, {\n          headers: {\n            \"DOLAPIKEY\": this.apiKey\n          }\n        });\n        if (!response.ok) throw new Error(`Erreur réseau: ${response.statusText}`);\n        const invoice = await response.json();\n        this.invoice = invoice => {\n          console.log(\"Facture récupéré:\", product);\n          return {\n            id: invoice.id,\n            ref: invoice.ref,\n            total_ht: invoice.total_ht,\n            total_tva: invoice.total_tva,\n            total_ttc: invoice.total_ttc,\n            product_name: invoice.lines.ref,\n            product_total_ht: invoice.lines.total_ht,\n            product_quantity: invoice.lines.qty,\n            product_unit_price_ht: product_total_ht / product_quantity,\n            product_tva: invoice.lines.tva_tx,\n            date_creation: invoice.date_creation\n          };\n        };\n        console.log('Produits récupérés et traités:', this.products);\n      } catch (error) {\n        console.error(\"Erreur lors de la récupération des produits:\", error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["html2pdf","name","data","apiKey","localStorage","getItem","apiLink","clientId","invoiceId","created","getInvoice","methods","exportToPDF","document","getElementById","margin","filename","console","log","Error","url","response","fetch","headers","ok","statusText","invoice","json","product","id","ref","total_ht","total_tva","total_ttc","product_name","lines","product_total_ht","product_quantity","qty","product_unit_price_ht","product_tva","tva_tx","date_creation","products","error"],"sources":["/Users/macbookpro/Sham/S6/stellarz-web/stellarz-b/stellar-web/src/components/InvoiceSection.vue"],"sourcesContent":["<template>\n    <div id=\"app\" ref=\"document\">\n      <div id=\"element-to-convert\">\n\n        <div class=\"logo\">\n            <img src=\"/Property 1=Variant2.png\" alt=\"Logo de la marque\" />\n        </div>\n\n        <div class=\"entete\">\n            <h1>Facture{{ invoice.ref}}</h1>\n            <h3>Date facturation : {{ invoice.date_creation}}</h3>\n            <h3>Date échéance : {{ invoice.date_creation}}</h3>\n        </div>\n\n        <div class=\"emetteur\">\n            <h3>VR 61 HF Ambohimiandra</h3>\n            <h3>101 Antananarivo</h3>\n            <h3>Madagascar</h3>\n            <h3>Tél.: +261349933136</h3>\n        </div>\n\n        <div class=\"client\">\n            <b>VR 61 HF Ambohimiandra</b>\n        </div>\n\n        <div class=\"ref-commande\">\n            <h4>Commandes</h4>\n            <h4>{{ invoice.ref}}</h4>\n            <h4>Réf. commande :</h4>\n            <h4>Date de commande : 09/04/2025</h4>\n        </div>\n\n        <table class=\"detail-commande\">\n        <tr>\n            <th class=\"detail-commande-designation\">Désignation</th>\n            <th>TVA   </th>\n            <th>P.U. HT</th>\n            <th>Qté</th>\n            <th>Total HT</th>\n        </tr>\n        <tr>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n        </tr>\n        </table>\n\n        <div class=\"bas-de-page\">\n            <b>Total HT</b>\n            <b>Total TVA</b>\n            <b>Total TTC</b>\n        </div>\n\n        <div class=\"details-paiement\">\n            <table class=\"small-table\">\n                <th>Versements déjà effectués</th>\n                <tr>\n                    <td>Règlement</td>\n                    <td>Montant</td>\n                    <td>Type</td>\n                </tr>\n                <tr>\n                    <td>Règlement</td>\n                    <td>Montant</td>\n                    <td>Type</td>\n                </tr>\n            </table>\n        </div>\n\n      </div>\n    </div>\n    <button @click=\"exportToPDF\">Export to PDF</button>\n  </template>\n\n<script>\nimport html2pdf from \"html2pdf.js\";\n\nexport default {\n  name: \"InvoiceSection\",\n  data() {\n    return {\n      apiKey: localStorage.getItem(\"apiKey\"),\n      apiLink: localStorage.getItem(\"apiLink\"),\n      clientId: localStorage.getItem(\"clientId\"),\n      invoiceId: localStorage.getItem(\"invoiceId\"),\n    };\n  },\n  created() {\n    this.getInvoice();\n  },\n  \n  methods: {\n    exportToPDF() {\n      html2pdf(document.getElementById(\"element-to-convert\"), {\n        margin: 1,\n        filename: \"generated-pdf.pdf\",\n      });\n    },\n\n    async getInvoice(){\n\n        try {\n    console.log('Tentative de récupération des produits depuis Dolibarr...');\n    if (!this.apiKey || !this.apiLink) throw new Error(\"API Key ou API Link manquant\");\n\n    const url = `${this.apiLink}/invoices/${this.invoiceId}`;\n    const response = await fetch(url, {\n      headers: {\n        \"DOLAPIKEY\": this.apiKey\n      }\n    });\n\n    if (!response.ok) throw new Error(`Erreur réseau: ${response.statusText}`);\n    const invoice = await response.json();\n    this.invoice = invoice => {\n      console.log(\"Facture récupéré:\", product);\n      return {\n        id: invoice.id,\n        ref: invoice.ref,\n        total_ht: invoice.total_ht,\n        total_tva:invoice.total_tva,\n        total_ttc:invoice.total_ttc,\n        product_name: invoice.lines.ref,\n        product_total_ht: invoice.lines.total_ht,\n        product_quantity: invoice.lines.qty,\n        product_unit_price_ht: product_total_ht/product_quantity,\n        product_tva: invoice.lines.tva_tx,\n        date_creation: invoice.date_creation\n        \n      };\n      \n    };\n    \n    console.log('Produits récupérés et traités:', this.products);\n  } catch (error) {\n    console.error(\"Erreur lors de la récupération des produits:\", error);\n  }\n\n    },\n  },\n};\n</script>\n  \n  <style>\n  #app {\n    margin-top: 60px;\n  }\n  </style>"],"mappings":"AA6EA,OAAOA,QAAO,MAAO,aAAa;AAElC,eAAe;EACbC,IAAI,EAAE,gBAAgB;EACtBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,MAAM,EAAEC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;MACtCC,OAAO,EAAEF,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;MACxCE,QAAQ,EAAEH,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;MAC1CG,SAAS,EAAEJ,YAAY,CAACC,OAAO,CAAC,WAAW;IAC7C,CAAC;EACH,CAAC;EACDI,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,UAAU,CAAC,CAAC;EACnB,CAAC;EAEDC,OAAO,EAAE;IACPC,WAAWA,CAAA,EAAG;MACZZ,QAAQ,CAACa,QAAQ,CAACC,cAAc,CAAC,oBAAoB,CAAC,EAAE;QACtDC,MAAM,EAAE,CAAC;QACTC,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ,CAAC;IAED,MAAMN,UAAUA,CAAA,EAAE;MAEd,IAAI;QACRO,OAAO,CAACC,GAAG,CAAC,2DAA2D,CAAC;QACxE,IAAI,CAAC,IAAI,CAACf,MAAK,IAAK,CAAC,IAAI,CAACG,OAAO,EAAE,MAAM,IAAIa,KAAK,CAAC,8BAA8B,CAAC;QAElF,MAAMC,GAAE,GAAI,GAAG,IAAI,CAACd,OAAO,aAAa,IAAI,CAACE,SAAS,EAAE;QACxD,MAAMa,QAAO,GAAI,MAAMC,KAAK,CAACF,GAAG,EAAE;UAChCG,OAAO,EAAE;YACP,WAAW,EAAE,IAAI,CAACpB;UACpB;QACF,CAAC,CAAC;QAEF,IAAI,CAACkB,QAAQ,CAACG,EAAE,EAAE,MAAM,IAAIL,KAAK,CAAC,kBAAkBE,QAAQ,CAACI,UAAU,EAAE,CAAC;QAC1E,MAAMC,OAAM,GAAI,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;QACrC,IAAI,CAACD,OAAM,GAAIA,OAAM,IAAK;UACxBT,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEU,OAAO,CAAC;UACzC,OAAO;YACLC,EAAE,EAAEH,OAAO,CAACG,EAAE;YACdC,GAAG,EAAEJ,OAAO,CAACI,GAAG;YAChBC,QAAQ,EAAEL,OAAO,CAACK,QAAQ;YAC1BC,SAAS,EAACN,OAAO,CAACM,SAAS;YAC3BC,SAAS,EAACP,OAAO,CAACO,SAAS;YAC3BC,YAAY,EAAER,OAAO,CAACS,KAAK,CAACL,GAAG;YAC/BM,gBAAgB,EAAEV,OAAO,CAACS,KAAK,CAACJ,QAAQ;YACxCM,gBAAgB,EAAEX,OAAO,CAACS,KAAK,CAACG,GAAG;YACnCC,qBAAqB,EAAEH,gBAAgB,GAACC,gBAAgB;YACxDG,WAAW,EAAEd,OAAO,CAACS,KAAK,CAACM,MAAM;YACjCC,aAAa,EAAEhB,OAAO,CAACgB;UAEzB,CAAC;QAEH,CAAC;QAEDzB,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAE,IAAI,CAACyB,QAAQ,CAAC;MAC9D,EAAE,OAAOC,KAAK,EAAE;QACd3B,OAAO,CAAC2B,KAAK,CAAC,8CAA8C,EAAEA,KAAK,CAAC;MACtE;IAEE;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}