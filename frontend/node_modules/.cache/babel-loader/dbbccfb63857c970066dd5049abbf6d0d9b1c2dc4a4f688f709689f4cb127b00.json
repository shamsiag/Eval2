{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"orders-page\"\n};\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[1] || (_cache[1] = _createElementVNode(\"h1\", null, \"Mes Commandes\", -1 /* HOISTED */)), $data.orders.length ? (_openBlock(), _createElementBlock(\"table\", _hoisted_2, [_cache[0] || (_cache[0] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"Référence\"), _createElementVNode(\"th\", null, \"Date\"), _createElementVNode(\"th\", null, \"Total TTC\"), _createElementVNode(\"th\", null, \"Statut\")])], -1 /* HOISTED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.orders, order => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: order.id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(order.ref || order.id), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString($options.formatDate(order.date_creation)), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString($options.formatCurrency(order.total_ttc)), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString($options.getStatusText(order.status)), 1 /* TEXT */)]);\n  }), 128 /* KEYED_FRAGMENT */))])])) : (_openBlock(), _createElementBlock(\"p\", _hoisted_3, \"Aucune commande trouvée.\"))]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","$data","orders","length","_hoisted_2","_Fragment","_renderList","order","id","_toDisplayString","ref","$options","formatDate","date_creation","formatCurrency","total_ttc","getStatusText","status","_hoisted_3"],"sources":["/Users/macbookpro/Sham/S6/stellarz-web/stellarz-b/stellar-web/src/views/OrdersPage.vue"],"sourcesContent":["<template>\n    <div class=\"orders-page\">\n      <h1>Mes Commandes</h1>\n      <table v-if=\"orders.length\">\n        <thead>\n          <tr>\n            <th>Référence</th>\n            <th>Date</th>\n            <th>Total TTC</th>\n            <th>Statut</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"order in orders\" :key=\"order.id\">\n            <td>{{ order.ref || order.id }}</td>\n            <td>{{ formatDate(order.date_creation) }}</td>\n            <td>{{ formatCurrency(order.total_ttc) }}</td>\n            <td>{{ getStatusText(order.status) }}</td>\n          </tr>\n        </tbody>\n      </table>\n      <p v-else>Aucune commande trouvée.</p>\n    </div>\n  </template>\n  \n  <script>\n  import axios from 'axios';\n  \n  export default {\n    name: 'MesCommandes',\n    data() {\n      return {\n        orders: [],\n        apiKey: localStorage.getItem('apiKey'),\n        apiLink: localStorage.getItem('apiLink'),\n        clientId: localStorage.getItem('clientId'),\n      };\n    },\n    created() {\n      this.fetchOrders();\n    },\n    methods: {\n      async fetchOrders() {\n        try {\n          if (!this.apiKey || !this.apiLink || !this.clientId) {\n            throw new Error(\"Données manquantes (API Key, API Link ou ClientId)\");\n          }\n          // Récupérer toutes les commandes du client\n          const url = `${this.apiLink}/orders?fk_soc=${this.clientId}`;\n          const response = await axios.get(url, {\n            headers: { \"DOLAPIKEY\": this.apiKey },\n          });\n          this.orders = response.data;\n          console.log(\"Commandes récupérées:\", this.orders);\n        } catch (error) {\n          console.error(\"Erreur lors de la récupération des commandes:\", error);\n        }\n      },\n      // Formatage du montant\n      formatCurrency(value) {\n        return new Intl.NumberFormat(\"fr-FR\", {\n          style: \"currency\",\n          currency: \"EUR\",\n        }).format(value);\n      },\n      // Convertir un timestamp Unix (en secondes) en date lisible\n      formatDate(timestamp) {\n        if (!timestamp) return \"Inconnue\";\n        const date = new Date(timestamp * 1000);\n        return date.toLocaleDateString(\"fr-FR\");\n      },\n      // Mapping des statuts selon vos correspondances\n      getStatusText(status) {\n        console.log(\"Statut de la commande:\", status);\n        console.log(\"StatuT:\", this.statut);\n        switch (status) {\n          case 0:\n            return \"Draft\";\n          case \"1\":\n            return \"Validéé\";\n          case 2:\n            return \"Invoice created\";\n          case 3:\n            return \"Delivered\";\n          case 4:\n            return \"Processed\";\n            case \"-1\":\n            return \"Canceled\";\n          default:\n            return \"Statut inconnu\";\n        }\n      },\n    },\n  };\n  </script>\n  \n  <style scoped>\n  .orders-page {\n    padding: 40px 20px;\n    background-color: #0e100e;\n    color: #f7f7f7;\n    font-family: 'PP Formula', sans-serif;\n  }\n  \n  h1 {\n    font-family: 'DAWBE';\n    font-size: 48px;\n    margin-bottom: 30px;\n    text-align: center;\n  }\n  \n  table {\n    width: 100%;\n    border-collapse: collapse;\n    background: white;\n    color: #1e1e1e;\n    border-radius: 8px;\n    overflow: hidden;\n    margin-bottom: 20px;\n  }\n  \n  th, td {\n    padding: 12px 15px;\n    border: 1px solid #ddd;\n  }\n  \n  th {\n    background-color: #5aaad8;\n    color: white;\n    text-align: left;\n  }\n  \n  tbody tr:nth-child(even) {\n    background-color: #f3f3f3;\n  }\n  </style>\n  "],"mappings":";;EACSA,KAAK,EAAC;AAAa;;EAD5BC,GAAA;AAAA;;EAAAA,GAAA;AAAA;;uBACIC,mBAAA,CAqBM,OArBNC,UAqBM,G,0BApBJC,mBAAA,CAAsB,YAAlB,eAAa,sBACJC,KAAA,CAAAC,MAAM,CAACC,MAAM,I,cAA1BL,mBAAA,CAiBQ,SApBdM,UAAA,G,0BAIQJ,mBAAA,CAOQ,gBANNA,mBAAA,CAKK,aAJHA,mBAAA,CAAkB,YAAd,WAAS,GACbA,mBAAA,CAAa,YAAT,MAAI,GACRA,mBAAA,CAAkB,YAAd,WAAS,GACbA,mBAAA,CAAe,YAAX,QAAM,E,wBAGdA,mBAAA,CAOQ,iB,kBANNF,mBAAA,CAKKO,SAAA,QAlBfC,WAAA,CAa8BL,KAAA,CAAAC,MAAM,EAAfK,KAAK;yBAAhBT,mBAAA,CAKK;MALwBD,GAAG,EAAEU,KAAK,CAACC;QACtCR,mBAAA,CAAoC,YAAAS,gBAAA,CAA7BF,KAAK,CAACG,GAAG,IAAIH,KAAK,CAACC,EAAE,kBAC5BR,mBAAA,CAA8C,YAAAS,gBAAA,CAAvCE,QAAA,CAAAC,UAAU,CAACL,KAAK,CAACM,aAAa,mBACrCb,mBAAA,CAA8C,YAAAS,gBAAA,CAAvCE,QAAA,CAAAG,cAAc,CAACP,KAAK,CAACQ,SAAS,mBACrCf,mBAAA,CAA0C,YAAAS,gBAAA,CAAnCE,QAAA,CAAAK,aAAa,CAACT,KAAK,CAACU,MAAM,kB;uDAIvCnB,mBAAA,CAAsC,KArB5CoB,UAAA,EAqBgB,0BAAwB,G","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}