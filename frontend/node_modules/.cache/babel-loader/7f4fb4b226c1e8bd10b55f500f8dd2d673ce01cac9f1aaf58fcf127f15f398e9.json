{"ast":null,"code":"import html2pdf from \"html2pdf.js\";\nexport default {\n  name: \"InvoiceSection\",\n  data() {\n    return {\n      apiKey: localStorage.getItem(\"apiKey\"),\n      apiLink: localStorage.getItem(\"apiLink\"),\n      clientId: localStorage.getItem(\"clientId\"),\n      invoiceId: localStorage.getItem(\"invoiceId\")\n    };\n  },\n  created() {\n    this.invoice = \"\";\n    this.getInvoice();\n  },\n  methods: {\n    exportToPDF() {\n      html2pdf(document.getElementById(\"element-to-convert\"), {\n        margin: 1,\n        filename: \"generated-pdf.pdf\"\n      });\n    },\n    async getInvoice() {\n      console.log(\"invoice Id:\", this.invoiceId);\n      try {\n        console.log('Tentative de récupération des factures depuis Dolibarr...');\n        if (!this.apiKey || !this.apiLink) throw new Error(\"API Key ou API Link manquant\");\n        const url = `${this.apiLink}/invoices/${this.invoiceId}`;\n        console.log(\"url\", url);\n        const response = await fetch(url, {\n          headers: {\n            \"Accept\": \"application/json\",\n            DOLAPIKEY: this.apiKey\n          }\n        });\n        if (!response.ok) throw new Error(`Erreur réseau: ${response.statusText}`);\n        var invoices = await response.json();\n        this.invoice = invoices;\n        console.log('Produits récupérés et traités:', invoices);\n      } catch (error) {\n        console.error(\"Erreur lors de la récupération des produits:\", error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["html2pdf","name","data","apiKey","localStorage","getItem","apiLink","clientId","invoiceId","created","invoice","getInvoice","methods","exportToPDF","document","getElementById","margin","filename","console","log","Error","url","response","fetch","headers","DOLAPIKEY","ok","statusText","invoices","json","error"],"sources":["/Users/macbookpro/Sham/S6/stellarz-web/stellarz-b/stellar-web/src/views/InvoicePage.vue"],"sourcesContent":["<template>\n    <div id=\"app\" ref=\"document\">\n      <div id=\"element-to-convert\">\n\n        <div class=\"logo\">\n            <img src=\"/Property 1=Variant2.png\" alt=\"Logo de la marque\" />\n        </div>\n\n        <div class=\"entete\">\n            <h1>Facture{{ this.invoice.ref}}</h1>\n            <h3>Date facturation : {{ this.invoice.date_creation}}</h3>\n            <h3>Date échéance : {{ this.invoice.date_creation}}</h3>\n        </div>\n\n        <div class=\"emetteur\">\n            <h3>VR 61 HF Ambohimiandra</h3>\n            <h3>101 Antananarivo</h3>\n            <h3>Madagascar</h3>\n            <h3>Tél.: +261349933136</h3>\n        </div>\n\n        <div class=\"client\">\n            <b>VR 61 HF Ambohimiandra</b>\n        </div>\n\n        <div class=\"ref-commande\">\n            <h4>Commandes</h4>\n            <h4>{{ thisinvoice.ref}}</h4>\n            <h4>Réf. commande :</h4>\n            <h4>Date de commande : 09/04/2025</h4>\n        </div>\n\n        <table class=\"detail-commande\">\n        <tr>\n            <th class=\"detail-commande-designation\">Désignation</th>\n            <th>TVA   </th>\n            <th>P.U. HT</th>\n            <th>Qté</th>\n            <th>Total HT</th>\n        </tr>\n        <tr>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n        </tr>\n        </table>\n\n        <div class=\"bas-de-page\">\n            <b>Total HT</b>\n            <b>Total TVA</b>\n            <b>Total TTC</b>\n        </div>\n\n        <div class=\"details-paiement\">\n            <table class=\"small-table\">\n                <th>Versements déjà effectués</th>\n                <tr>\n                    <td>Règlement</td>\n                    <td>Montant</td>\n                    <td>Type</td>\n                </tr>\n                <tr>\n                    <td>Règlement</td>\n                    <td>Montant</td>\n                    <td>Type</td>\n                </tr>\n            </table>\n        </div>\n\n      </div>\n    </div>\n    <button @click=\"exportToPDF\">Export to PDF</button>\n  </template>\n\n<script>\nimport html2pdf from \"html2pdf.js\";\n\nexport default {\n  name: \"InvoiceSection\",\n  data() {\n    return {\n      apiKey: localStorage.getItem(\"apiKey\"),\n      apiLink: localStorage.getItem(\"apiLink\"),\n      clientId: localStorage.getItem(\"clientId\"),\n      invoiceId: localStorage.getItem(\"invoiceId\"),\n    };\n  },\n  created() {\n    this.invoice=\"\";\n    this.getInvoice();\n\n  },\n  \n  methods: {\n    exportToPDF() {\n      html2pdf(document.getElementById(\"element-to-convert\"), {\n        margin: 1,\n        filename: \"generated-pdf.pdf\",\n      });\n    },\n\n    async getInvoice(){\n        console.log(\"invoice Id:\",this.invoiceId);\n        try {\n    console.log('Tentative de récupération des factures depuis Dolibarr...');\n    if (!this.apiKey || !this.apiLink) throw new Error(\"API Key ou API Link manquant\");\n\n    const url = `${this.apiLink}/invoices/${this.invoiceId}`;\n    console.log(\"url\",url);\n    const response = await fetch(url, {\n          headers: { \"Accept\": \"application/json\", DOLAPIKEY: this.apiKey, },\n        });\n    \n    if (!response.ok) throw new Error(`Erreur réseau: ${response.statusText}`);\n    var invoices = await response.json();\n    this.invoice = invoices;\n    \n    console.log('Produits récupérés et traités:',invoices);\n  } catch (error) {\n    console.error(\"Erreur lors de la récupération des produits:\", error);\n  }\n\n    },\n  },\n};\n</script>\n  \n  <style>\n  #app {\n    margin-top: 60px;\n    color: aliceblue;\n  }\n\n  </style>"],"mappings":"AA6EA,OAAOA,QAAO,MAAO,aAAa;AAElC,eAAe;EACbC,IAAI,EAAE,gBAAgB;EACtBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,MAAM,EAAEC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;MACtCC,OAAO,EAAEF,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;MACxCE,QAAQ,EAAEH,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;MAC1CG,SAAS,EAAEJ,YAAY,CAACC,OAAO,CAAC,WAAW;IAC7C,CAAC;EACH,CAAC;EACDI,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,OAAO,GAAC,EAAE;IACf,IAAI,CAACC,UAAU,CAAC,CAAC;EAEnB,CAAC;EAEDC,OAAO,EAAE;IACPC,WAAWA,CAAA,EAAG;MACZb,QAAQ,CAACc,QAAQ,CAACC,cAAc,CAAC,oBAAoB,CAAC,EAAE;QACtDC,MAAM,EAAE,CAAC;QACTC,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ,CAAC;IAED,MAAMN,UAAUA,CAAA,EAAE;MACdO,OAAO,CAACC,GAAG,CAAC,aAAa,EAAC,IAAI,CAACX,SAAS,CAAC;MACzC,IAAI;QACRU,OAAO,CAACC,GAAG,CAAC,2DAA2D,CAAC;QACxE,IAAI,CAAC,IAAI,CAAChB,MAAK,IAAK,CAAC,IAAI,CAACG,OAAO,EAAE,MAAM,IAAIc,KAAK,CAAC,8BAA8B,CAAC;QAElF,MAAMC,GAAE,GAAI,GAAG,IAAI,CAACf,OAAO,aAAa,IAAI,CAACE,SAAS,EAAE;QACxDU,OAAO,CAACC,GAAG,CAAC,KAAK,EAACE,GAAG,CAAC;QACtB,MAAMC,QAAO,GAAI,MAAMC,KAAK,CAACF,GAAG,EAAE;UAC5BG,OAAO,EAAE;YAAE,QAAQ,EAAE,kBAAkB;YAAEC,SAAS,EAAE,IAAI,CAACtB;UAAQ;QACnE,CAAC,CAAC;QAEN,IAAI,CAACmB,QAAQ,CAACI,EAAE,EAAE,MAAM,IAAIN,KAAK,CAAC,kBAAkBE,QAAQ,CAACK,UAAU,EAAE,CAAC;QAC1E,IAAIC,QAAO,GAAI,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;QACpC,IAAI,CAACnB,OAAM,GAAIkB,QAAQ;QAEvBV,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAACS,QAAQ,CAAC;MACxD,EAAE,OAAOE,KAAK,EAAE;QACdZ,OAAO,CAACY,KAAK,CAAC,8CAA8C,EAAEA,KAAK,CAAC;MACtE;IAEE;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}